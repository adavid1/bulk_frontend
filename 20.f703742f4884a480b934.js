(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{uiWJ:function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),u=function(){return function(){}}(),o=t("pMnS"),i=t("oBZk"),s=t("ZZ/e"),r=t("Ip0R"),c=t("mrSG"),a=t("QNcV"),b=t("t/Na"),h=t("AytR"),d=function(){function n(n,l,t,e,u,o,i){var s=this;this.authService=n,this.toastr=l,this.handler=t,this.http=e,this.route=u,this.socket=o,this.API_URL=h.a.API_URL_DEV,this.http=new b.c(t),i.params.subscribe((function(n){s.init()}))}return n.prototype.ngOnInit=function(){return c.__awaiter(this,void 0,void 0,(function(){return c.__generator(this,(function(n){return[2]}))}))},n.prototype.init=function(){return c.__awaiter(this,void 0,void 0,(function(){var n,l=this;return c.__generator(this,(function(t){switch(t.label){case 0:return n={headers:new b.g({"Content-Type":"application/json",Authorization:"Bearer "+this.authService.getToken()})},this.userId=this.authService.hasToken()&&!this.authService.hasTokenExpired()?this.authService.getLoggedUser().userid:JSON.parse(localStorage.getItem("userIdGuest")),[4,this.http.get(this.API_URL+"/user/"+this.userId,n).toPromise().then((function(n){l.sessionId=null!=n.session?n.session.sessionId:n.sessionHost.sessionId}))];case 1:return t.sent(),null==this.sessionId&&this.route.navigate(["home"]),[4,this.http.get(this.API_URL+"/session/"+this.sessionId,n).toPromise().then((function(n){l.sessionId=n.sessionId,l.players=n.players,l.session=n,l.owner=n.owner.userId==l.userId}))];case 2:return t.sent(),this.socket.emit("joinSession",this.userId,this.sessionId),this.socket.fromEvent("joinSession").subscribe((function(t){return c.__awaiter(l,void 0,void 0,(function(){var l=this;return c.__generator(this,(function(e){switch(e.label){case 0:return[4,this.http.get(this.API_URL+"/user/"+t,n).subscribe((function(n){n.userId!=l.session.owner.userId&&(n.color="#"+(16777216+16777215*Math.random()).toString(16).substr(1,6)),l.players.push(n)}))];case 1:return e.sent(),[2]}}))}))})),this.socket.fromEvent("quitSession").subscribe((function(n){return c.__awaiter(l,void 0,void 0,(function(){return c.__generator(this,(function(l){return this.players=this.players.filter((function(l){return l.userId!==n})),[2]}))}))})),this.socket.fromEvent("killSession").subscribe((function(n){return c.__awaiter(l,void 0,void 0,(function(){return c.__generator(this,(function(n){return this.route.navigate(["home"]),[2]}))}))})),this.socket.fromEvent("joinGame").subscribe((function(n){return c.__awaiter(l,void 0,void 0,(function(){return c.__generator(this,(function(n){return this.route.navigate(["game"]),[2]}))}))})),[2]}}))}))},n.prototype.ready=function(){this.players.length<2&&console.log("ne pas lancÃ© si < 3"),this.socket.emit("joinGame",this.sessionId),this.toastr.success("Game started","Game"),this.route.navigate(["/host"])},n.prototype.quit=function(){var n=this,l={headers:new b.g({"Content-Type":"application/json"})};this.http.put(this.API_URL+"/session/removeuser/"+this.sessionId,{userId:this.userId},l).subscribe((function(l){n.socket.emit("quitSession",n.userId,n.sessionId),n.socket.removeAllListeners()}),(function(l){n.toastr.error(l,"Quit session error")}),(function(){n.toastr.success("Session successfully quitted","Session"),n.route.navigate(["home"])}))},n.prototype.delete=function(){var n=this;this.http.delete(this.API_URL+"/session/delete/"+this.sessionId).subscribe((function(l){n.socket.emit("killSession",n.sessionId),n.socket.removeAllListeners()}),(function(l){n.toastr.error(l,"Quit session error")}),(function(){n.toastr.success("Session successfully quitted","Session"),n.route.navigate(["home"])}))},n}(),p=t("SZbH"),f=t("ZYCi"),g=t("92vz"),m=e.Ab({encapsulation:0,styles:[[".room-card[_ngcontent-%COMP%]{width:60%;height:auto;margin:15px auto}.room-card-content[_ngcontent-%COMP%]{white-space:nowrap;font-size:8vmin;font-weight:700;text-align:center;vertical-align:middle}.player-card[_ngcontent-%COMP%]{width:50%;height:auto;margin:auto auto 5px;text-align:center}.player-avatar[_ngcontent-%COMP%]{width:100%;height:100%;max-width:6vw;max-height:6vh;margin:auto}"]],data:{}});function v(n){return e.Vb(0,[(n()(),e.Cb(0,0,null,null,4,"ion-button",[["color","danger"],["fill","solid"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.delete()&&e),e}),i.E,i.c)),e.Bb(1,49152,null,0,s.k,[e.j,e.p,e.G],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.Cb(2,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,i.O,i.m)),e.Bb(3,49152,null,0,s.C,[e.j,e.p,e.G],{name:[0,"name"]},null),(n()(),e.Ub(-1,0,["Delete session "]))],(function(n,l){n(l,1,0,"danger","solid"),n(l,3,0,"trash")}),null)}function I(n){return e.Vb(0,[(n()(),e.Cb(0,0,null,null,4,"ion-button",[["color","danger"],["fill","solid"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.quit()&&e),e}),i.E,i.c)),e.Bb(1,49152,null,0,s.k,[e.j,e.p,e.G],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.Cb(2,0,null,0,1,"ion-icon",[["name","close"],["slot","icon-only"]],null,null,null,i.O,i.m)),e.Bb(3,49152,null,0,s.C,[e.j,e.p,e.G],{name:[0,"name"]},null),(n()(),e.Ub(-1,0,["Quit "]))],(function(n,l){n(l,1,0,"danger","solid"),n(l,3,0,"close")}),null)}function _(n){return e.Vb(0,[(n()(),e.Cb(0,0,null,null,4,"ion-button",[["color","success"],["fill","solid"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.ready()&&e),e}),i.E,i.c)),e.Bb(1,49152,null,0,s.k,[e.j,e.p,e.G],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.Cb(2,0,null,0,1,"ion-icon",[["name","play"],["slot","icon-only"]],null,null,null,i.O,i.m)),e.Bb(3,49152,null,0,s.C,[e.j,e.p,e.G],{name:[0,"name"]},null),(n()(),e.Ub(-1,0,["Ready "]))],(function(n,l){n(l,1,0,"success","solid"),n(l,3,0,"play")}),null)}function y(n){return e.Vb(0,[(n()(),e.Cb(0,0,null,null,10,"ion-card",[["class","player-card"]],null,null,null,i.J,i.e)),e.Bb(1,49152,null,0,s.m,[e.j,e.p,e.G],null,null),(n()(),e.Cb(2,0,null,0,8,"ion-card-content",[],null,null,null,i.G,i.f)),e.Bb(3,49152,null,0,s.n,[e.j,e.p,e.G],null,null),(n()(),e.Cb(4,0,null,0,5,"ion-avatar",[["class","player-avatar"]],null,null,null,i.D,i.b)),e.Rb(512,null,r.q,r.r,[e.p,e.z,e.L]),e.Bb(6,278528,null,0,r.l,[r.q],{ngStyle:[0,"ngStyle"]},null),e.Qb(7,{"background-color":0}),e.Bb(8,49152,null,0,s.g,[e.j,e.p,e.G],null,null),(n()(),e.Cb(9,0,null,0,0,"img",[["src","assets/icon/bulk-logo.png"]],null,null,null,null,null)),(n()(),e.Ub(10,0,[" "," "]))],(function(n,l){var t=n(l,7,0,l.context.$implicit.color);n(l,6,0,t)}),(function(n,l){n(l,10,0,l.context.$implicit.username)}))}function k(n){return e.Vb(0,[(n()(),e.Cb(0,0,null,null,12,"ion-header",[],null,null,null,i.N,i.l)),e.Bb(1,49152,null,0,s.B,[e.j,e.p,e.G],null,null),(n()(),e.Cb(2,0,null,0,10,"ion-toolbar",[],null,null,null,i.db,i.B)),e.Bb(3,49152,null,0,s.Cb,[e.j,e.p,e.G],null,null),(n()(),e.Cb(4,0,null,0,2,"ion-title",[],null,null,null,i.bb,i.z)),e.Bb(5,49152,null,0,s.Ab,[e.j,e.p,e.G],null,null),(n()(),e.Ub(-1,0,["PRE GAME"])),(n()(),e.rb(16777216,null,0,1,null,v)),e.Bb(8,16384,null,0,r.i,[e.X,e.T],{ngIf:[0,"ngIf"]},null),(n()(),e.rb(16777216,null,0,1,null,I)),e.Bb(10,16384,null,0,r.i,[e.X,e.T],{ngIf:[0,"ngIf"]},null),(n()(),e.rb(16777216,null,0,1,null,_)),e.Bb(12,16384,null,0,r.i,[e.X,e.T],{ngIf:[0,"ngIf"]},null),(n()(),e.Cb(13,0,null,null,11,"ion-content",[],null,null,null,i.L,i.j)),e.Bb(14,49152,null,0,s.u,[e.j,e.p,e.G],null,null),(n()(),e.Cb(15,0,null,0,7,"ion-card",[["class","room-card"]],null,null,null,i.J,i.e)),e.Bb(16,49152,null,0,s.m,[e.j,e.p,e.G],null,null),(n()(),e.Cb(17,0,null,0,5,"ion-card-content",[],null,null,null,i.G,i.f)),e.Bb(18,49152,null,0,s.n,[e.j,e.p,e.G],null,null),(n()(),e.Cb(19,0,null,0,3,"div",[["class","room-card-content"]],null,null,null,null,null)),(n()(),e.Ub(-1,null,[" ROOM CODE "])),(n()(),e.Cb(21,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),e.Ub(22,null,[" "," "])),(n()(),e.rb(16777216,null,0,1,null,y)),e.Bb(24,278528,null,0,r.h,[e.X,e.T,e.y],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){var t=l.component;n(l,8,0,t.owner),n(l,10,0,!t.owner),n(l,12,0,t.owner),n(l,24,0,t.players)}),(function(n,l){n(l,22,0,l.component.sessionId)}))}function C(n){return e.Vb(0,[(n()(),e.Cb(0,0,null,null,1,"app-pre-game",[],null,null,null,k,m)),e.Bb(1,114688,null,0,d,[a.a,p.j,b.b,b.c,f.m,g.a,f.a],null,null)],(function(n,l){n(l,1,0)}),null)}var w=e.yb("app-pre-game",d,C,{},{},[]),G=t("gIcY"),B=function(){return function(){}}();t.d(l,"PreGamePageModuleNgFactory",(function(){return j}));var j=e.zb(u,[],(function(n){return e.Lb([e.Mb(512,e.m,e.kb,[[8,[o.a,w]],[3,e.m],e.E]),e.Mb(4608,r.k,r.j,[e.A,[2,r.t]]),e.Mb(4608,G.q,G.q,[]),e.Mb(4608,s.b,s.b,[e.G,e.g]),e.Mb(4608,s.Gb,s.Gb,[s.b,e.m,e.x]),e.Mb(4608,s.Kb,s.Kb,[s.b,e.m,e.x]),e.Mb(1073742336,r.b,r.b,[]),e.Mb(1073742336,G.p,G.p,[]),e.Mb(1073742336,G.g,G.g,[]),e.Mb(1073742336,s.Eb,s.Eb,[]),e.Mb(1073742336,f.o,f.o,[[2,f.t],[2,f.m]]),e.Mb(1073742336,B,B,[]),e.Mb(1073742336,u,u,[]),e.Mb(1024,f.k,(function(){return[[{path:"",component:d}]]}),[])])}))}}]);