(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{uiWJ:function(n,l,t){"use strict";t.r(l);var e=t("CcnG"),o=function(){return function(){}}(),s=t("pMnS"),u=t("oBZk"),i=t("ZZ/e"),r=t("Ip0R"),c=t("mrSG"),a=t("QNcV"),b=t("t/Na"),h=t("AytR"),f=function(){function n(n,l,t,e,o,s,u){var i=this;this.authService=n,this.toastr=l,this.handler=t,this.http=e,this.route=o,this.socket=s,this.API_URL=h.a.API_URL_DEV,this.http=new b.c(t),u.params.subscribe((function(n){i.init()}))}return n.prototype.ngOnInit=function(){return c.__awaiter(this,void 0,void 0,(function(){return c.__generator(this,(function(n){return[2]}))}))},n.prototype.init=function(){return c.__awaiter(this,void 0,void 0,(function(){var n,l=this;return c.__generator(this,(function(t){switch(t.label){case 0:return n={headers:new b.g({"Content-Type":"application/json",Authorization:"Bearer "+this.authService.getToken()})},this.userId=this.authService.hasToken()&&!this.authService.hasTokenExpired()?this.authService.getLoggedUser().userid:JSON.parse(localStorage.getItem("userIdGuest")),[4,this.http.get(this.API_URL+"/user/"+this.userId,n).toPromise().then((function(n){l.sessionId=null!=n.session?n.session.sessionId:n.sessionHost.sessionId}))];case 1:return t.sent(),null==this.sessionId&&this.route.navigate(["home"]),[4,this.http.get(this.API_URL+"/session/"+this.sessionId,n).toPromise().then((function(n){l.sessionId=n.sessionId,l.players=n.players,l.session=n,l.owner=n.owner.userId==l.userId}))];case 2:return t.sent(),this.socket.emit("joinSession",this.userId,this.sessionId),this.socket.fromEvent("joinSession").subscribe((function(t){return c.__awaiter(l,void 0,void 0,(function(){var l=this;return c.__generator(this,(function(e){switch(e.label){case 0:return[4,this.http.get(this.API_URL+"/user/"+t,n).subscribe((function(n){n.userId!=l.session.owner.userId&&null==l.session.players.find((function(l){return l.userId==n.userId}))&&(l.affectColor(t),n.color=l.color,l.players.push(n))}))];case 1:return e.sent(),[2]}}))}))})),this.socket.fromEvent("quitSession").subscribe((function(n){return c.__awaiter(l,void 0,void 0,(function(){return c.__generator(this,(function(l){return this.players=this.players.filter((function(l){return l.userId!==n})),[2]}))}))})),this.socket.fromEvent("killSession").subscribe((function(n){return c.__awaiter(l,void 0,void 0,(function(){return c.__generator(this,(function(n){return this.route.navigate(["home"]),[2]}))}))})),this.socket.fromEvent("joinGame").subscribe((function(n){return c.__awaiter(l,void 0,void 0,(function(){return c.__generator(this,(function(n){return this.route.navigate(["game"]),[2]}))}))})),[2]}}))}))},n.prototype.ready=function(){this.players.length<=2?this.toastr.warning("You need at leat 3 players to start a game"):this.players.length>10?this.toastr.warning("You can't start a game with more than 10 players"):(this.socket.emit("joinGame",this.sessionId),this.toastr.success("Game started","Game"),this.route.navigate(["/host"]))},n.prototype.quit=function(){var n=this,l={headers:new b.g({"Content-Type":"application/json"})};this.http.put(this.API_URL+"/session/removeuser/"+this.sessionId,{userId:this.userId},l).subscribe((function(l){n.socket.emit("quitSession",n.userId,n.sessionId),n.socket.removeAllListeners()}),(function(l){n.toastr.error(l,"Quit session error")}),(function(){n.toastr.success("Session successfully quitted","Session"),n.route.navigate(["home"])}))},n.prototype.delete=function(){var n=this;this.http.delete(this.API_URL+"/session/delete/"+this.sessionId).subscribe((function(l){n.socket.emit("killSession",n.sessionId),n.socket.removeAllListeners()}),(function(l){n.toastr.error(l,"Quit session error")}),(function(){n.toastr.success("Session successfully quitted","Session"),n.route.navigate(["home"])}))},n.prototype.affectColor=function(n){return c.__awaiter(this,void 0,void 0,(function(){var l;return c.__generator(this,(function(t){switch(t.label){case 0:switch(this.players.length){case 0:this.color="#0066ff";break;case 1:this.color="#ff5050";break;case 2:this.color="#838383";break;case 3:this.color="#ff00ff";break;case 4:this.color="#00cc00";break;case 5:this.color="#ffff00";break;case 6:this.color="#993300";break;case 7:this.color="#cc00ff";break;case 8:this.color="#000000";break;default:this.color="#ff6600"}return l={headers:new b.g({"Content-Type":"application/json",Authorization:"Bearer "+this.authService.getToken()})},[4,this.http.put(this.API_URL+"/user/setcolor/"+n,{color:this.color},l).toPromise().then((function(n){console.log(n)}))];case 1:return t.sent(),[2]}}))}))},n}(),p=t("SZbH"),d=t("ZYCi"),g=t("92vz"),m=e.Bb({encapsulation:0,styles:[[".room-card[_ngcontent-%COMP%]{width:60%;height:auto;margin:15px auto}.room-card-content[_ngcontent-%COMP%]{white-space:nowrap;font-size:8vmin;font-weight:700;text-align:center;vertical-align:middle}.player-card[_ngcontent-%COMP%]{width:50%;height:auto;margin:auto auto 5px;text-align:center}.player-avatar[_ngcontent-%COMP%]{width:100%;height:100%;max-width:6vw;margin:auto}"]],data:{}});function v(n){return e.Wb(0,[(n()(),e.Db(0,0,null,null,4,"ion-button",[["color","danger"],["fill","solid"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.delete()&&e),e}),u.G,u.c)),e.Cb(1,49152,null,0,i.k,[e.j,e.p,e.G],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.Db(2,0,null,0,1,"ion-icon",[["name","trash"],["slot","icon-only"]],null,null,null,u.R,u.n)),e.Cb(3,49152,null,0,i.C,[e.j,e.p,e.G],{name:[0,"name"]},null),(n()(),e.Vb(-1,0,["Delete session "]))],(function(n,l){n(l,1,0,"danger","solid"),n(l,3,0,"trash")}),null)}function I(n){return e.Wb(0,[(n()(),e.Db(0,0,null,null,4,"ion-button",[["color","danger"],["fill","solid"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.quit()&&e),e}),u.G,u.c)),e.Cb(1,49152,null,0,i.k,[e.j,e.p,e.G],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.Db(2,0,null,0,1,"ion-icon",[["name","close"],["slot","icon-only"]],null,null,null,u.R,u.n)),e.Cb(3,49152,null,0,i.C,[e.j,e.p,e.G],{name:[0,"name"]},null),(n()(),e.Vb(-1,0,["Quit "]))],(function(n,l){n(l,1,0,"danger","solid"),n(l,3,0,"close")}),null)}function y(n){return e.Wb(0,[(n()(),e.Db(0,0,null,null,4,"ion-button",[["color","success"],["fill","solid"]],null,[[null,"click"]],(function(n,l,t){var e=!0;return"click"===l&&(e=!1!==n.component.ready()&&e),e}),u.G,u.c)),e.Cb(1,49152,null,0,i.k,[e.j,e.p,e.G],{color:[0,"color"],fill:[1,"fill"]},null),(n()(),e.Db(2,0,null,0,1,"ion-icon",[["name","play"],["slot","icon-only"]],null,null,null,u.R,u.n)),e.Cb(3,49152,null,0,i.C,[e.j,e.p,e.G],{name:[0,"name"]},null),(n()(),e.Vb(-1,0,["Ready "]))],(function(n,l){n(l,1,0,"success","solid"),n(l,3,0,"play")}),null)}function k(n){return e.Wb(0,[(n()(),e.Db(0,0,null,null,12,"ion-card",[["class","player-card"]],null,null,null,u.L,u.e)),e.Cb(1,49152,null,0,i.m,[e.j,e.p,e.G],null,null),(n()(),e.Db(2,0,null,0,10,"ion-card-content",[],null,null,null,u.I,u.f)),e.Cb(3,49152,null,0,i.n,[e.j,e.p,e.G],null,null),(n()(),e.Db(4,0,null,0,5,"ion-avatar",[["class","player-avatar"]],null,null,null,u.F,u.b)),e.Sb(512,null,r.y,r.z,[e.p,e.z,e.M]),e.Cb(6,278528,null,0,r.m,[r.y],{ngStyle:[0,"ngStyle"]},null),e.Rb(7,{"background-color":0}),e.Cb(8,49152,null,0,i.g,[e.j,e.p,e.G],null,null),(n()(),e.Db(9,0,null,0,0,"img",[["src","assets/icon/bulk-logo.png"]],null,null,null,null,null)),(n()(),e.Db(10,0,null,0,2,"ion-label",[],null,null,null,u.U,u.q)),e.Cb(11,49152,null,0,i.N,[e.j,e.p,e.G],null,null),(n()(),e.Vb(12,0,["",""]))],(function(n,l){var t=n(l,7,0,l.context.$implicit.color);n(l,6,0,t)}),(function(n,l){n(l,12,0,l.context.$implicit.username)}))}function _(n){return e.Wb(0,[(n()(),e.Db(0,0,null,null,12,"ion-header",[],null,null,null,u.Q,u.m)),e.Cb(1,49152,null,0,i.B,[e.j,e.p,e.G],null,null),(n()(),e.Db(2,0,null,0,10,"ion-toolbar",[],null,null,null,u.hb,u.D)),e.Cb(3,49152,null,0,i.Cb,[e.j,e.p,e.G],null,null),(n()(),e.Db(4,0,null,0,2,"ion-title",[],null,null,null,u.fb,u.B)),e.Cb(5,49152,null,0,i.Ab,[e.j,e.p,e.G],null,null),(n()(),e.Vb(-1,0,["PRE GAME"])),(n()(),e.sb(16777216,null,0,1,null,v)),e.Cb(8,16384,null,0,r.j,[e.Y,e.U],{ngIf:[0,"ngIf"]},null),(n()(),e.sb(16777216,null,0,1,null,I)),e.Cb(10,16384,null,0,r.j,[e.Y,e.U],{ngIf:[0,"ngIf"]},null),(n()(),e.sb(16777216,null,0,1,null,y)),e.Cb(12,16384,null,0,r.j,[e.Y,e.U],{ngIf:[0,"ngIf"]},null),(n()(),e.Db(13,0,null,null,11,"ion-content",[],null,null,null,u.N,u.j)),e.Cb(14,49152,null,0,i.u,[e.j,e.p,e.G],null,null),(n()(),e.Db(15,0,null,0,7,"ion-card",[["class","room-card"]],null,null,null,u.L,u.e)),e.Cb(16,49152,null,0,i.m,[e.j,e.p,e.G],null,null),(n()(),e.Db(17,0,null,0,5,"ion-card-content",[],null,null,null,u.I,u.f)),e.Cb(18,49152,null,0,i.n,[e.j,e.p,e.G],null,null),(n()(),e.Db(19,0,null,0,3,"div",[["class","room-card-content"]],null,null,null,null,null)),(n()(),e.Vb(-1,null,[" ROOM CODE "])),(n()(),e.Db(21,0,null,null,0,"br",[],null,null,null,null,null)),(n()(),e.Vb(22,null,[" "," "])),(n()(),e.sb(16777216,null,0,1,null,k)),e.Cb(24,278528,null,0,r.i,[e.Y,e.U,e.y],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){var t=l.component;n(l,8,0,t.owner),n(l,10,0,!t.owner),n(l,12,0,t.owner),n(l,24,0,t.players)}),(function(n,l){n(l,22,0,l.component.sessionId)}))}function w(n){return e.Wb(0,[(n()(),e.Db(0,0,null,null,1,"app-pre-game",[],null,null,null,_,m)),e.Cb(1,114688,null,0,f,[a.a,p.j,b.b,b.c,d.m,g.a,d.a],null,null)],(function(n,l){n(l,1,0)}),null)}var C=e.zb("app-pre-game",f,w,{},{},[]),G=t("gIcY"),j=function(){return function(){}}();t.d(l,"PreGamePageModuleNgFactory",(function(){return D}));var D=e.Ab(o,[],(function(n){return e.Mb([e.Nb(512,e.m,e.lb,[[8,[s.a,C]],[3,e.m],e.E]),e.Nb(4608,r.l,r.k,[e.A,[2,r.B]]),e.Nb(4608,G.s,G.s,[]),e.Nb(4608,i.b,i.b,[e.G,e.g]),e.Nb(4608,i.Gb,i.Gb,[i.b,e.m,e.x]),e.Nb(4608,i.Kb,i.Kb,[i.b,e.m,e.x]),e.Nb(1073742336,r.b,r.b,[]),e.Nb(1073742336,G.r,G.r,[]),e.Nb(1073742336,G.g,G.g,[]),e.Nb(1073742336,i.Eb,i.Eb,[]),e.Nb(1073742336,d.o,d.o,[[2,d.t],[2,d.m]]),e.Nb(1073742336,j,j,[]),e.Nb(1073742336,o,o,[]),e.Nb(1024,d.k,(function(){return[[{path:"",component:f}]]}),[])])}))}}]);